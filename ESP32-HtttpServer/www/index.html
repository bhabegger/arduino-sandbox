<html>
  <head>
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous">
</script>
<link
  rel="stylesheet" 
  href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
  integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
  crossorigin="anonymous">
</link>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
  crossorigin="anonymous">
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<script>
const key_enter = 13;
const key_up    = 38;
const key_down  = 40;
const key_right = 39;
const key_left  = 37;
const key_esc   = 27;
const key_space = 32;
const key_ctrl  = 17;
const key_alt   = 18;
const key_shift = 16;

function updateConsole(data,status,jqXHR) {
  $("#console").html(data);
}

var commands = {
  stop: function() {
    console.log("Stop");
    $.get("/stop",null,updateConsole);
  },
  forward: function() {
    console.log("Forward");
    $.get("/forward",null,updateConsole)
  },
  backward: function() {
    console.log("Backward");
    $.get("/backward",null,updateConsole)
  },
  left: function() {
    console.log("Left");
    $.get("/left",null,updateConsole)
  },
  right: function() {
    console.log("Right");
    $.get("/right",null,updateConsole)
  }
}

function updateCapture() {
  $("#capture").attr('src','/capture?time='+Date.now());
}

$(function() {
  $("body").keydown(function(evt) {
    switch(evt.which) {
       case key_up: 
         commands.forward();
         break;
       case key_down:
         commands.backward();
         break;
      case key_right:
         commands.right();
         break;
      case key_left:
         commands.left();
         break;
      case key_space:
         commands.stop();
         break;
    }
  });

  $("#stop").click(commands.stop);
  $("#forward").click(commands.forward);
  $("#backward").click(commands.backward);
  $("#left").click(commands.left);
  $("#right").click(commands.right);

  setInterval(updateCapture, 1000);
});

</script>
</head>
<body>
  <div class="container-fluid">
    <div id="cam" class="alert alert-secondary d-flex justify-content-center" role="alert">
      <img id="capture" src="/capture" />
    </div>
  </div>
<div class="container">
  <div class="row p-2">
    <div class="col-sm d-flex justify-content-center">
    </div>
    <div class="col-sm d-flex justify-content-center">
      <button id="forward" type="button" class="btn btn-dark">Forward</button>
    </div>
    <div class="col-sm d-flex justify-content-center">
    </div>
  </div>
  <div class="row p-2">
    <div class="col-sm d-flex justify-content-center">
      <button id="left" type="button" class="btn btn-dark">Left</button>
    </div>
    <div class="col-sm d-flex justify-content-center">
      <button id="stop" type="button" class="btn btn-dark">Stop</button>
    </div>
    <div class="col-sm d-flex justify-content-center">
      <button id="right" type="button" class="btn btn-dark">Right</button>
    </div>
  </div>
    <div class="row p-2">
    <div class="col-sm d-flex justify-content-center">
    </div>
    <div class="col-sm d-flex justify-content-center">
      <button id="backward" type="button" class="btn btn-dark">Backward</button>
    </div>
    <div class="col-sm d-flex justify-content-center">
    </div>
  </div>
  </div>
  <div class="container-fluid">
    <div id="console" class="alert alert-secondary d-flex justify-content-center" role="alert">
          Welcome
    </div>
  </div>
</body>
</html>
